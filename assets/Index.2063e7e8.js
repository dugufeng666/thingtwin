import{f as H,S as ce,d as O,j as Y,s as ee,r as w,o as _,U as x,V as a,k as e,W as n,E as pe,G as fe,X as q,F as B,J as V,Y as ge,Z as J,c as I,_ as ve,$ as _e,w as he,u as we,a0 as ae,K as X}from"./vue-vendor.eb926c9c.js";import{c as G,g as xe,d as be,P as oe}from"./meta2d.de3edc3f.js";import{M as ye,_ as z}from"./index.31bc681c.js";import{u as le,S as ne,V as ke}from"./View.c825a8da.js";var ie={exports:{}};(function(D,h){(function(l,p){p()})(G,function(){function l(d,c){return typeof c>"u"?c={autoBom:!1}:typeof c!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),c={autoBom:!c}),c.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(d.type)?new Blob(["\uFEFF",d],{type:d.type}):d}function p(d,c,k){var f=new XMLHttpRequest;f.open("GET",d),f.responseType="blob",f.onload=function(){v(f.response,c,k)},f.onerror=function(){console.error("could not download file")},f.send()}function y(d){var c=new XMLHttpRequest;c.open("HEAD",d,!1);try{c.send()}catch{}return 200<=c.status&&299>=c.status}function A(d){try{d.dispatchEvent(new MouseEvent("click"))}catch{var c=document.createEvent("MouseEvents");c.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),d.dispatchEvent(c)}}var m=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof G=="object"&&G.global===G?G:void 0,b=m.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),v=m.saveAs||(typeof window!="object"||window!==m?function(){}:"download"in HTMLAnchorElement.prototype&&!b?function(d,c,k){var f=m.URL||m.webkitURL,r=document.createElement("a");c=c||d.name||"download",r.download=c,r.rel="noopener",typeof d=="string"?(r.href=d,r.origin===location.origin?A(r):y(r.href)?p(d,c,k):A(r,r.target="_blank")):(r.href=f.createObjectURL(d),setTimeout(function(){f.revokeObjectURL(r.href)},4e4),setTimeout(function(){A(r)},0))}:"msSaveOrOpenBlob"in navigator?function(d,c,k){if(c=c||d.name||"download",typeof d!="string")navigator.msSaveOrOpenBlob(l(d,k),c);else if(y(d))p(d,c,k);else{var f=document.createElement("a");f.href=d,f.target="_blank",setTimeout(function(){A(f)})}}:function(d,c,k,f){if(f=f||open("","_blank"),f&&(f.document.title=f.document.body.innerText="downloading..."),typeof d=="string")return p(d,c,k);var r=d.type==="application/octet-stream",o=/constructor/i.test(m.HTMLElement)||m.safari,j=/CriOS\/[\d]+/.test(navigator.userAgent);if((j||r&&o||b)&&typeof FileReader<"u"){var P=new FileReader;P.onloadend=function(){var E=P.result;E=j?E:E.replace(/^data:[^;]*;/,"data:attachment/file;"),f?f.location.href=E:location=E,f=null},P.readAsDataURL(d)}else{var T=m.URL||m.webkitURL,U=T.createObjectURL(d);f?f.location=U:location.href=U,f=null,setTimeout(function(){T.revokeObjectURL(U)},4e4)}});m.saveAs=v.saveAs=v,D.exports=v})})(ie);var Ce=ie.exports;const Se=xe(Ce),Ve={class:"app-header"},Ae={class:"app-header"},Pe={class:"l-icon","aria-hidden":"true"},Ue=["xlink:href"],Le=["onClick"],Ee={class:"l-icon","aria-hidden":"true"},$e=["xlink:href"],Re={class:"l-icon","aria-hidden":"true"},De=["xlink:href"],Te=["onClick"],Fe={class:"l-icon","aria-hidden":"true"},Ne=["xlink:href"],Oe={class:"l-icon","aria-hidden":"true"},je=["xlink:href"],Me=["onClick"],Be={class:"l-icon","aria-hidden":"true"},Ie=["xlink:href"],He=H({__name:"Header",setup(D){const h=ce(),l=O(!1),p=O(0);Y(()=>{const i=setInterval(()=>{meta2d&&(clearInterval(i),y(meta2d.store.data.scale),meta2d.on("scale",y))},200)});const y=i=>{p.value=Math.round(i*100)},A=()=>{l.value?(l.value=!1,meta2d.finishDrawLine(),meta2d.drawLine(),meta2d.store.options.disableAnchor=!0):(l.value=!0,meta2d.drawLine(meta2d.store.options.drawingLineName),meta2d.store.options.disableAnchor=!1)},m=ee([{name:"曲线",icon:"#l-curve2",value:"curve"},{name:"线段",icon:"#l-polyline",value:"polyline"},{name:"直线",icon:"#l-line",value:"line"},{name:"脑图曲线",icon:"#l-mind",value:"mind"}]),b=O("curve"),v=i=>{var t;b.value=i,meta2d&&(meta2d.store.options.drawingLineName=i,meta2d.canvas.drawingLineName&&(meta2d.canvas.drawingLineName=i),(t=meta2d.store.active)==null||t.forEach(s=>{meta2d.updateLineType(s,i)}))},d=O(""),c=[{icon:"#l-line",value:""},{icon:"#l-from-triangle",value:"triangle"},{icon:"#l-from-diamond",value:"diamond"},{icon:"#l-from-circle",value:"circle"},{icon:"#l-from-lineDown",value:"lineDown"},{icon:"#l-from-lineUp",value:"lineUp"},{icon:"#l-from-triangleSolid",value:"triangleSolid"},{icon:"#l-from-diamondSolid",value:"diamondSolid"},{icon:"#l-from-circleSolid",value:"circleSolid"},{icon:"#l-from-line",value:"line"}],k=O(""),f=[{icon:"#l-line",value:""},{icon:"#l-to-triangle",value:"triangle"},{icon:"#l-to-diamond",value:"diamond"},{icon:"#l-to-circle",value:"circle"},{icon:"#l-to-lineDown",value:"lineDown"},{icon:"#l-to-lineUp",value:"lineUp"},{icon:"#l-to-triangleSolid",value:"triangleSolid"},{icon:"#l-to-diamondSolid",value:"diamondSolid"},{icon:"#l-to-circleSolid",value:"circleSolid"},{icon:"#l-to-line",value:"line"}],r=i=>{d.value=i,meta2d.store.data.fromArrow=i,meta2d.store.active&&(meta2d.store.active.forEach(t=>{t.type===oe.Line&&(t.fromArrow=i,meta2d.setValue({id:t.id,fromArrow:t.fromArrow},{render:!1}))}),meta2d.render())},o=i=>{k.value=i,meta2d.store.data.toArrow=i,meta2d.store.active&&(meta2d.store.active.forEach(t=>{t.type===oe.Line&&(t.toArrow=i,meta2d.setValue({id:t.id,toArrow:t.toArrow},{render:!1}))}),meta2d.render())},j=()=>{meta2d.open({name:"新建项目",pens:[]})};function P(i){return new Promise((t,s)=>{const g=new FileReader;g.onload=()=>{t(g.result)},g.onerror=s,g.readAsText(i)})}const T=()=>{const i=document.createElement("input");i.type="file",i.onchange=async t=>{const s=t.target;if(s.files&&s.files[0]){const g=await P(s.files[0]);try{meta2d.open(JSON.parse(g)),meta2d.fitView()}catch($){console.log($)}}},i.click()},U=()=>{const i=meta2d.data();Se.saveAs(new Blob([JSON.stringify(i)],{type:"text/plain;charset=utf-8"}),`${i.name||"le5le.meta2d"}.json`)},E=()=>{let i=meta2d.store.data.name;i&&(i+=".png"),meta2d.downloadPng(i)};function F(i,t){var g;let s=i;for(;s&&s.parentId;){const $=s;s=t.pens[s.parentId];const L=(g=s==null?void 0:s.calculative)==null?void 0:g.showChild;if(L!=null&&s.children[L]!==$.id)return!1}return!0}const K=()=>{if(!C2S){ye.error("请先加载乐吾乐官网下的canvas2svg.js");return}const i=meta2d.getRect();i.x-=10,i.y-=10;const t=new C2S(i.width+20,i.height+20);t.textBaseline="middle";for(const S of meta2d.store.data.pens)S.visible==!1||!F(S,meta2d.store)||meta2d.renderPenRaw(t,S,i);let s=t.getSerializedSvg();meta2d.store.data.background?(s=s.replace("{{bk}}",""),s=s.replace("{{bkRect}}",`<rect x="0" y="0" width="100%" height="100%" fill="${meta2d.store.data.background}"></rect>`)):(s=s.replace("{{bk}}",""),s=s.replace("{{bkRect}}","")),s=s.replace(/--le5le--/g,"&#x");const g=window.URL||window,$=new Blob([s]),L=g.createObjectURL($),R=document.createElement("a");R.setAttribute("download",`${meta2d.store.data.name||"le5le.meta2d"}.svg`),R.setAttribute("href",L);const C=document.createEvent("MouseEvents");C.initEvent("click",!0,!0),R.dispatchEvent(C)},M=()=>{meta2d.undo()},N=()=>{meta2d.redo()},Z=()=>{meta2d.cut()},Q=()=>{meta2d.copy()},u=()=>{meta2d.paste()},de=()=>{meta2d.activeAll()},se=()=>{meta2d.delete()},W=(i,t)=>{var g;i.stopPropagation();let s;t==="text"?s={text:"text",width:100,height:20,name:"text"}:t==="line"&&(s={anchors:[{id:"0",x:1,y:0},{id:"1",x:0,y:1}],width:100,height:100,name:"line",lineName:"line",type:1}),i.dataTransfer?(g=i.dataTransfer)==null||g.setData("Meta2d",JSON.stringify(s)):meta2d.canvas.addCaches=be([s])},re=()=>{meta2d.scale(1),meta2d.centerView()},ue=()=>{meta2d.fitView()},me=()=>{meta2d.stopAnimate();const i=meta2d.data();localStorage.setItem("meta2d",JSON.stringify(i)),h.push({path:"/preview",query:{r:Date.now()+"",id:i._id}})};return(i,t)=>{const s=w("t-dropdown"),g=w("t-dropdown-item"),$=w("t-dropdown-menu"),L=w("t-tooltip"),R=w("t-icon");return _(),x(B,null,[a("div",Ve,[e(s,{minColumnWidth:200,maxHeight:560,overlayClassName:"header-dropdown"},{default:n(()=>t[4]||(t[4]=[a("span",null,"数字孪生编辑器",-1)])),_:1,__:[4]}),e(s,{minColumnWidth:200,maxHeight:560,overlayClassName:"header-dropdown"},{default:n(()=>[t[7]||(t[7]=a("a",null," 文件 ",-1)),e($,null,{default:n(()=>[e(g,{onClick:j},{default:n(()=>t[5]||(t[5]=[a("a",null,"新建文件",-1)])),_:1,__:[5]}),e(g,{onClick:T,divider:"true"},{default:n(()=>t[6]||(t[6]=[a("a",null,"打开文件",-1)])),_:1,__:[6]}),e(g,{divider:"true"},{default:n(()=>[a("a",{onClick:U},"下载JSON文件")]),_:1}),e(g,null,{default:n(()=>[a("a",{onClick:E},"下载为PNG")]),_:1}),e(g,null,{default:n(()=>[a("a",{onClick:K},"下载为SVG")]),_:1})]),_:1})]),_:1,__:[7]}),e(s,{minColumnWidth:180,maxHeight:500,overlayClassName:"header-dropdown"},{default:n(()=>[t[15]||(t[15]=a("a",null," 编辑 ",-1)),e($,null,{default:n(()=>[e(g,null,{default:n(()=>[a("a",{onClick:M},t[8]||(t[8]=[a("div",{class:"flex"},[V(" 撤销 "),a("span",{class:"flex-grow"}),V(" Ctrl + Z ")],-1)]))]),_:1}),e(g,{divider:"true"},{default:n(()=>[a("a",{onClick:N},t[9]||(t[9]=[a("div",{class:"flex"},[V(" 恢复 "),a("span",{class:"flex-grow"}),V(" Ctrl + Y ")],-1)]))]),_:1}),e(g,null,{default:n(()=>[a("a",{onClick:Z},t[10]||(t[10]=[a("div",{class:"flex"},[V(" 剪切 "),a("span",{class:"flex-grow"}),V(" Ctrl + X ")],-1)]))]),_:1}),e(g,null,{default:n(()=>[a("a",{onClick:Q},t[11]||(t[11]=[a("div",{class:"flex"},[V(" 复制 "),a("span",{class:"flex-grow"}),V(" Ctrl + C ")],-1)]))]),_:1}),e(g,{divider:"true"},{default:n(()=>[a("a",{onClick:u},t[12]||(t[12]=[a("div",{class:"flex"},[V(" 粘贴 "),a("span",{class:"flex-grow"}),V(" Ctrl + V ")],-1)]))]),_:1}),e(g,null,{default:n(()=>[a("a",{onClick:de},t[13]||(t[13]=[a("div",{class:"flex"},[V(" 全选 "),a("span",{class:"flex-grow"}),V(" Ctrl + A ")],-1)]))]),_:1}),e(g,null,{default:n(()=>[a("a",{onClick:se},t[14]||(t[14]=[a("div",{class:"flex"},[V("删除 "),a("span",{class:"flex-grow"}),V(" DELETE")],-1)]))]),_:1})]),_:1})]),_:1,__:[15]})]),a("div",Ae,[e(L,{content:"撤销"},{default:n(()=>[(_(),x("svg",{class:"l-icon","aria-hidden":"true",onClick:M},t[16]||(t[16]=[a("use",{"xlink:href":"#l-undo"},null,-1)])))]),_:1}),e(L,{content:"重做"},{default:n(()=>[(_(),x("svg",{class:"l-icon","aria-hidden":"true",onClick:N},t[17]||(t[17]=[a("use",{"xlink:href":"#l-redo"},null,-1)])))]),_:1}),e(L,{content:"直线"},{default:n(()=>[a("span",{draggable:!0,onDragstart:t[0]||(t[0]=C=>W(C,"line")),onClick:t[1]||(t[1]=C=>W(C,"line"))},[e(R,{name:"slash"})],32)]),_:1}),e(L,{content:"文字"},{default:n(()=>[a("span",{draggable:!0,onDragstart:t[2]||(t[2]=C=>W(C,"text")),onClick:t[3]||(t[3]=C=>W(C,"text"))},t[18]||(t[18]=[a("svg",{class:"l-icon","aria-hidden":"true"},[a("use",{"xlink:href":"#l-text"})],-1)]),32)]),_:1}),e(L,{content:"连线"},{default:n(()=>[(_(),x("svg",{width:"1em",height:"1em",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",onClick:A,style:ge({color:l.value?" #1677ff":""})},t[19]||(t[19]=[a("path",{d:"M192 64a128 128 0 0 1 123.968 96H384a160 160 0 0 1 159.68 149.504L544 320v384a96 96 0 0 0 86.784 95.552L640 800h68.032a128 128 0 1 1 0 64.064L640 864a160 160 0 0 1-159.68-149.504L480 704V320a96 96 0 0 0-86.784-95.552L384 224l-68.032 0.064A128 128 0 1 1 192 64z m640 704a64 64 0 1 0 0 128 64 64 0 0 0 0-128zM192 128a64 64 0 1 0 0 128 64 64 0 0 0 0-128z",fill:"currentColor"},null,-1)]),4))]),_:1}),e(s,{minColumnWidth:160,maxHeight:560,overlayClassName:"header-dropdown"},{default:n(()=>{var C;return[a("a",null,[(_(),x("svg",Pe,[a("use",{"xlink:href":(C=m.find(S=>S.value===b.value))==null?void 0:C.icon},null,8,Ue)]))]),e($,null,{default:n(()=>[(_(!0),x(B,null,J(m,S=>(_(),I(g,null,{default:n(()=>[a("div",{class:"flex middle",onClick:te=>v(S.value)},[V(q(S.name)+" ",1),t[20]||(t[20]=a("span",{class:"flex-grow"},null,-1)),(_(),x("svg",Ee,[a("use",{"xlink:href":S.icon},null,8,$e)]))],8,Le)]),_:2},1024))),256))]),_:1})]}),_:1}),e(s,{minColumnWidth:160,maxHeight:560,delay2:[10,150],overlayClassName:"header-dropdown"},{default:n(()=>{var C;return[a("a",null,[(_(),x("svg",Re,[a("use",{"xlink:href":(C=c.find(S=>S.value===d.value))==null?void 0:C.icon},null,8,De)]))]),e($,null,{default:n(()=>[(_(),x(B,null,J(c,S=>e(g,null,{default:n(()=>[a("div",{class:"flex middle",style:{height:"30px"},onClick:te=>r(S.value)},[(_(),x("svg",Fe,[a("use",{"xlink:href":S.icon},null,8,Ne)]))],8,Te)]),_:2},1024)),64))]),_:1})]}),_:1}),e(s,{minColumnWidth:160,maxHeight:560,delay2:[10,150],overlayClassName:"header-dropdown"},{default:n(()=>{var C;return[a("a",null,[(_(),x("svg",Oe,[a("use",{"xlink:href":(C=f.find(S=>S.value===k.value))==null?void 0:C.icon},null,8,je)]))]),e($,null,{default:n(()=>[(_(),x(B,null,J(f,S=>e(g,null,{default:n(()=>[a("div",{class:"flex middle",style:{height:"30px"},onClick:te=>o(S.value)},[(_(),x("svg",Be,[a("use",{"xlink:href":S.icon},null,8,Ie)]))],8,Me)]),_:2},1024)),64))]),_:1})]}),_:1}),t[21]||(t[21]=a("div",{style:{width:"64px"}},null,-1)),pe(a("div",{style:{"line-height":"40px"}},q(p.value)+"%",513),[[fe,p.value>0]]),e(L,{content:"100%视图",placement:"bottom"},{default:n(()=>[a("a",{onClick:re},[e(R,{name:"refresh"})])]),_:1}),e(L,{content:"窗口大小",placement:"bottom"},{default:n(()=>[a("a",{onClick:ue,style:{"margin-left":"-16px"}},[e(R,{name:"fullscreen-exit"})])]),_:1}),t[22]||(t[22]=a("div",{style:{width:"36px"}},null,-1)),e(L,{content:"运行查看"},{default:n(()=>[e(R,{name:"play-circle-stroke",onClick:me})]),_:1})])],64)}}});const ze=z(He,[["__scopeId","data-v-179e987c"]]),Ge={class:"graphics"},Je=["onDragstart","onClick"],We=["src","alt"],Xe=["title"],qe=H({__name:"Graphics",setup(D){const h=[{name:"设备",show:!0,list:[{name:"分集水器",icon:"l-device-separator",id:"device_1",data:{width:100,height:40,name:"image",text:"分集水器",image:"/devices/separator.svg",textPosition:"bottom",textColor:"#fff"}},{name:"加药泵",icon:"l-device-pump",id:"device_2",data:{width:40,height:80,name:"image",text:"加药泵",image:"/devices/pump.svg",textPosition:"bottom",textColor:"#fff"}},{name:"加药箱",icon:"l-device-tank",id:"device_3",data:{width:60,height:100,name:"image",text:"加药箱",image:"/devices/tank.svg",textPosition:"bottom",textColor:"#fff"}},{name:"加药箱2",icon:"l-device-tank2",id:"device_4",data:{width:60,height:100,name:"image",text:"加药箱2",image:"/devices/tank2.svg",textPosition:"bottom",textColor:"#fff"}},{name:"压力表",icon:"l-device-gauge",id:"device_5",data:{width:60,height:60,name:"image",text:"压力表",image:"/devices/gauge.svg",textPosition:"bottom",textColor:"#fff"}},{name:"压滤机",icon:"l-device-filter",id:"device_6",data:{width:120,height:40,name:"image",text:"压滤机",image:"/devices/filter.svg",textPosition:"bottom",textColor:"#fff"}},{name:"回流泵",icon:"l-device-pump2",id:"device_7",data:{width:80,height:40,name:"image",text:"回流泵",image:"/devices/pump2.svg",textPosition:"bottom",textColor:"#fff"}},{name:"废水池",icon:"l-device-pool",id:"device_8",data:{width:120,height:120,name:"image",text:"废水池",image:"/devices/pool.svg",textPosition:"bottom",textColor:"#fff"}},{name:"排水泵",icon:"l-device-drain",id:"device_9",data:{width:80,height:40,name:"image",text:"排水泵",image:"/devices/drain.svg",textPosition:"bottom",textColor:"#fff"}},{name:"污泥收集",icon:"l-device-sludge",id:"device_10",data:{width:120,height:120,name:"image",text:"污泥收集",image:"/devices/sludge.svg",textPosition:"bottom",textColor:"#fff"}},{name:"污泥泵",icon:"l-device-sludge-pump",id:"device_11",data:{width:40,height:100,name:"image",text:"污泥泵",image:"/devices/sludge-pump.svg",textPosition:"bottom",textColor:"#fff"}},{name:"沉淀池",icon:"l-device-settling",id:"device_12",data:{width:150,height:150,name:"image",text:"沉淀池",image:"/devices/settling.svg",textPosition:"bottom",textColor:"#fff"}}]},{name:"基本形状",show:!0,list:[{name:"正方形",icon:"l-rect",id:1,data:{width:100,height:100,name:"rectangle",strokeStyle:"rgb(0, 31, 151)"}},{name:"矩形",icon:"l-rectangle",id:2,data:{width:200,height:50,name:"rectangle",borderRadius:.1,strokeStyle:"rgb(0, 31, 151)"}},{name:"圆",icon:"l-circle",id:3,data:{width:100,height:100,name:"circle",strokeStyle:"rgb(0, 31, 151)"}},{name:"三角形",icon:"l-triangle",id:4,data:{width:100,height:100,name:"triangle",strokeStyle:"rgb(0, 31, 151)"}},{name:"菱形",icon:"l-diamond",id:5,data:{width:100,height:100,name:"diamond",strokeStyle:"rgb(0, 31, 151)"}},{name:"五边形",icon:"l-pentagon",id:6,data:{width:100,height:100,name:"pentagon",strokeStyle:"rgb(0, 31, 151)"}},{name:"六边形",icon:"l-hexagon",id:7,data:{width:100,height:100,name:"hexagon",strokeStyle:"rgb(0, 31, 151)"}},{name:"五角星",icon:"l-pentagram",id:8,data:{width:100,height:100,name:"pentagram",strokeStyle:"rgb(0, 31, 151)"}},{name:"左箭头",icon:"l-arrow-left",id:9,data:{width:120,height:60,name:"leftArrow",strokeStyle:"rgb(0, 31, 151)"}},{name:"右箭头",icon:"l-arrow-right",id:10,data:{width:120,height:60,name:"rightArrow",strokeStyle:"rgb(0, 31, 151)"}},{name:"双向箭头",icon:"l-twoway-arrow",id:11,data:{width:150,height:60,name:"twowayArrow",strokeStyle:"rgb(0, 31, 151)"}},{name:"云",icon:"l-cloud",id:13,data:{width:100,height:100,name:"cloud",strokeStyle:"rgb(0, 31, 151)"}},{name:"消息框",icon:"l-msg",id:14,data:{width:100,height:100,name:"message",textTop:-.1,strokeStyle:"rgb(0, 31, 151)"}},{name:"文件",icon:"l-file",id:15,data:{width:80,height:100,name:"file",strokeStyle:"rgb(0, 31, 151)"}},{name:"立方体",icon:"l-cube",id:18,data:{width:100,height:100,name:"cube",strokeStyle:"rgb(0, 31, 151)"}},{name:"人",icon:"l-people",id:19,data:{width:70,height:100,name:"people",strokeStyle:"rgb(0, 31, 151)"}}]}],l=(p,y)=>{var A;y&&(p.stopPropagation(),p instanceof DragEvent?(A=p.dataTransfer)==null||A.setData("Meta2d",JSON.stringify(y.data)):meta2d.canvas.addCaches=[y.data])};return(p,y)=>{const A=w("t-collapse-panel"),m=w("t-collapse");return _(),x("div",Ge,[e(m,{defaultExpandAll:!0},{default:n(()=>[(_(),x(B,null,J(h,b=>e(A,{header:b.name,key:b.name},{default:n(()=>[(_(!0),x(B,null,J(b.list,v=>(_(),x("div",{class:"graphic",draggable:!0,onDragstart:d=>l(d,v),onClick:ve(d=>l(d,v),["prevent"])},[v.data.image?(_(),x("img",{key:0,src:v.data.image,alt:v.name,class:"l-icon"},null,8,We)):(_(),x("div",{key:1,class:_e([v.icon,"l-icon"])},null,2)),a("p",{title:v.name},q(v.name),9,Xe)],40,Je))),256))]),_:2},1032,["header"])),64))]),_:1})])}}});const Ye=z(qe,[["__scopeId","data-v-2987cd6a"]]),Ke={class:"props-panel"},Ze=H({__name:"FileProps",setup(D){const h=ee({name:"",background:void 0,color:void 0}),l=ee({grid:!1,gridSize:10,gridRotate:void 0,gridColor:void 0,rule:!0});Y(()=>{const A=meta2d.data();h.name=A.name||"",h.background=A.background,h.color=A.color,Object.assign(l,meta2d.getOptions())});const p=()=>{Object.assign(meta2d.store.data,h),meta2d.store.patchFlagsBackground=!0,meta2d.render()},y=()=>{meta2d.setOptions(l),meta2d.store.patchFlagsTop=!0,meta2d.store.patchFlagsBackground=!0,meta2d.render()};return(A,m)=>{const b=w("t-input"),v=w("t-form-item"),d=w("t-divider"),c=w("t-switch"),k=w("t-color-picker"),f=w("t-form");return _(),x("div",Ke,[e(f,{"label-align":"left"},{default:n(()=>[m[8]||(m[8]=a("h5",{class:"mb-24"},"图纸",-1)),e(v,{label:"图纸名称",name:"name"},{default:n(()=>[e(b,{modelValue:h.name,"onUpdate:modelValue":m[0]||(m[0]=r=>h.name=r),onChange:p},null,8,["modelValue"])]),_:1}),e(d),e(v,{label:"网格",name:"grid"},{default:n(()=>[e(c,{modelValue:l.grid,"onUpdate:modelValue":m[1]||(m[1]=r=>l.grid=r),onChange:y},null,8,["modelValue"])]),_:1}),e(v,{label:"网格大小",name:"gridSize"},{default:n(()=>[e(b,{modelValue:l.gridSize,"onUpdate:modelValue":m[2]||(m[2]=r=>l.gridSize=r),modelModifiers:{number:!0},onChange:y},null,8,["modelValue"])]),_:1}),e(v,{label:"网格角度",name:"gridRotate"},{default:n(()=>[e(b,{modelValue:l.gridRotate,"onUpdate:modelValue":m[3]||(m[3]=r=>l.gridRotate=r),modelModifiers:{number:!0},onChange:y},null,8,["modelValue"])]),_:1}),e(v,{label:"网格颜色",name:"gridColor"},{default:n(()=>[e(k,{class:"w-full",modelValue:l.gridColor,"onUpdate:modelValue":m[4]||(m[4]=r=>l.gridColor=r),"show-primary-color-preview":!1,format:"CSS","color-modes":["monochrome"],onChange:y},null,8,["modelValue"])]),_:1}),e(d),e(v,{label:"标尺",name:"rule"},{default:n(()=>[e(c,{modelValue:l.rule,"onUpdate:modelValue":m[5]||(m[5]=r=>l.rule=r),onChange:y},null,8,["modelValue"])]),_:1}),e(d),e(v,{label:"背景颜色",name:"background"},{default:n(()=>[e(k,{class:"w-full",modelValue:h.background,"onUpdate:modelValue":m[6]||(m[6]=r=>h.background=r),"show-primary-color-preview":!1,format:"CSS","color-modes":["monochrome"],onChange:p},null,8,["modelValue"])]),_:1}),e(v,{label:"图元默认颜色",name:"color"},{default:n(()=>[e(k,{class:"w-full",modelValue:h.color,"onUpdate:modelValue":m[7]||(m[7]=r=>h.color=r),"show-primary-color-preview":!1,format:"CSS","color-modes":["monochrome"],onChange:p},null,8,["modelValue"])]),_:1})]),_:1,__:[8]})])}}});const Qe=z(Ze,[["__scopeId","data-v-cfef9ece"]]),et={class:"props-panel"},tt={class:"ml-16",style:{width:"50px","line-height":"30px"}},ot=H({__name:"PenProps",setup(D){const{selections:h}=le(),l=O(),p=O();Y(()=>{y()});const y=()=>{l.value=h.pen,l.value.globalAlpha==null&&(l.value.globalAlpha=1),p.value=meta2d.getPenRect(l.value)},A=he(()=>h.pen.id,y),m=[void 0,[5,5]],b=r=>{const o={id:l.value.id};o[r]=l.value[r],r==="dash"&&(o.lineDash=m[o[r]]),meta2d.setValue(o,{render:!0})},v=r=>{const o={id:l.value.id};o[r]=p.value[r],meta2d.setValue(o,{render:!0})},d=()=>{meta2d.top(),meta2d.render()},c=()=>{meta2d.bottom(),meta2d.render()},k=()=>{meta2d.up(),meta2d.render()},f=()=>{meta2d.down(),meta2d.render()};return we(()=>{A()}),(r,o)=>{const j=w("t-input"),P=w("t-form-item"),T=w("t-color-picker"),U=w("t-option"),E=w("t-select"),F=w("t-input-number"),K=w("t-slider"),M=w("t-divider"),N=w("t-button"),Z=w("t-space"),Q=w("t-form");return _(),x("div",et,[l.value?(_(),I(Q,{key:0,"label-align":"left"},{default:n(()=>[o[28]||(o[28]=a("h5",{class:"mb-24"},"图元",-1)),e(P,{label:"文本",name:"text"},{default:n(()=>[e(j,{modelValue:l.value.text,"onUpdate:modelValue":o[0]||(o[0]=u=>l.value.text=u),onChange:o[1]||(o[1]=u=>b("text"))},null,8,["modelValue"])]),_:1}),e(P,{label:"颜色",name:"color"},{default:n(()=>[e(T,{class:"w-full",modelValue:l.value.color,"onUpdate:modelValue":o[2]||(o[2]=u=>l.value.color=u),"show-primary-color-preview":!1,format:"CSS","color-modes":["monochrome"],onChange:o[3]||(o[3]=u=>b("color"))},null,8,["modelValue"])]),_:1}),e(P,{label:"背景",name:"background"},{default:n(()=>[e(T,{class:"w-full",modelValue:l.value.background,"onUpdate:modelValue":o[4]||(o[4]=u=>l.value.background=u),"show-primary-color-preview":!1,format:"CSS","color-modes":["monochrome"],onChange:o[5]||(o[5]=u=>b("background"))},null,8,["modelValue"])]),_:1}),e(P,{label:"线条",name:"dash"},{default:n(()=>[e(E,{modelValue:l.value.dash,"onUpdate:modelValue":o[6]||(o[6]=u=>l.value.dash=u),onChange:o[7]||(o[7]=u=>b("dash"))},{default:n(()=>[(_(),I(U,{key:0,value:0,label:"实线"})),(_(),I(U,{key:1,value:1,label:"虚线"}))]),_:1},8,["modelValue"])]),_:1}),e(P,{label:"圆角",name:"borderRadius"},{default:n(()=>[e(F,{min:0,max:1,step:.01,modelValue:l.value.borderRadius,"onUpdate:modelValue":o[8]||(o[8]=u=>l.value.borderRadius=u),onChange:o[9]||(o[9]=u=>b("borderRadius"))},null,8,["modelValue"])]),_:1}),e(P,{label:"不透明度",name:"globalAlpha"},{default:n(()=>[e(K,{modelValue:l.value.globalAlpha,"onUpdate:modelValue":o[10]||(o[10]=u=>l.value.globalAlpha=u),min:0,max:1,step:.01,onChange:o[11]||(o[11]=u=>b("globalAlpha"))},null,8,["modelValue"]),a("span",tt,q(l.value.globalAlpha),1)]),_:1}),e(M),e(P,{label:"X",name:"x"},{default:n(()=>[e(F,{modelValue:p.value.x,"onUpdate:modelValue":o[12]||(o[12]=u=>p.value.x=u),onChange:o[13]||(o[13]=u=>v("x"))},null,8,["modelValue"])]),_:1}),e(P,{label:"Y",name:"y"},{default:n(()=>[e(F,{modelValue:p.value.y,"onUpdate:modelValue":o[14]||(o[14]=u=>p.value.y=u),onChange:o[15]||(o[15]=u=>v("y"))},null,8,["modelValue"])]),_:1}),e(P,{label:"宽",name:"width"},{default:n(()=>[e(F,{modelValue:p.value.width,"onUpdate:modelValue":o[16]||(o[16]=u=>p.value.width=u),onChange:o[17]||(o[17]=u=>v("width"))},null,8,["modelValue"])]),_:1}),e(P,{label:"高",name:"height"},{default:n(()=>[e(F,{modelValue:p.value.height,"onUpdate:modelValue":o[18]||(o[18]=u=>p.value.height=u),onChange:o[19]||(o[19]=u=>v("height"))},null,8,["modelValue"])]),_:1}),e(M),e(P,{label:"文字水平对齐",name:"textAlign"},{default:n(()=>[e(E,{modelValue:l.value.textAlign,"onUpdate:modelValue":o[20]||(o[20]=u=>l.value.textAlign=u),onChange:o[21]||(o[21]=u=>b("textAlign"))},{default:n(()=>[e(U,{key:"left",value:"left",label:"左对齐"}),e(U,{key:"center",value:"center",label:"居中"}),e(U,{key:"right",value:"right",label:"右对齐"})]),_:1},8,["modelValue"])]),_:1}),e(P,{label:"文字垂直对齐",name:"textBaseline"},{default:n(()=>[e(E,{modelValue:l.value.textBaseline,"onUpdate:modelValue":o[22]||(o[22]=u=>l.value.textBaseline=u),onChange:o[23]||(o[23]=u=>b("textBaseline"))},{default:n(()=>[e(U,{key:"top",value:"top",label:"顶部对齐"}),e(U,{key:"middle",value:"middle",label:"居中"}),e(U,{key:"bottom",value:"bottom",label:"底部对齐"})]),_:1},8,["modelValue"])]),_:1}),e(M),e(Z,null,{default:n(()=>[e(N,{onClick:d},{default:n(()=>o[24]||(o[24]=[V("置顶")])),_:1,__:[24]}),e(N,{onClick:c},{default:n(()=>o[25]||(o[25]=[V("置底")])),_:1,__:[25]}),e(N,{onClick:k},{default:n(()=>o[26]||(o[26]=[V("上一层")])),_:1,__:[26]}),e(N,{onClick:f},{default:n(()=>o[27]||(o[27]=[V("下一层")])),_:1,__:[27]})]),_:1})]),_:1,__:[28]})):ae("",!0)])}}});const nt=z(ot,[["__scopeId","data-v-6d34e1c9"]]),at={class:"app-props"},lt=H({__name:"Props",setup(D){const{selections:h}=le();return(l,p)=>(_(),x("div",at,[X(h).mode===X(ne).File?(_(),I(Qe,{key:0})):X(h).mode===X(ne).Pen?(_(),I(nt,{key:1})):ae("",!0)]))}});const it=z(lt,[["__scopeId","data-v-d3ccf652"]]),dt={class:"app-page"},st={class:"designer"},rt=H({__name:"Index",setup(D){let h;function l(){h&&clearTimeout(h),h=setTimeout(()=>{const p=meta2d.data();localStorage.setItem("meta2d",JSON.stringify(p)),h=void 0},1e3)}return Y(()=>{meta2d.on("scale",l),meta2d.on("add",l),meta2d.on("opened",l),meta2d.on("undo",l),meta2d.on("redo",l),meta2d.on("add",l),meta2d.on("delete",l),meta2d.on("rotatePens",l),meta2d.on("translatePens",l)}),(p,y)=>(_(),x("div",dt,[e(ze),a("div",st,[e(Ye),e(ke),e(it)])]))}});const ft=z(rt,[["__scopeId","data-v-f192b0ea"]]);export{ft as default};
