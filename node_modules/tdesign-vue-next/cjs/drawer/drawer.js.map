{"version":3,"file":"drawer.js","sources":["../../../components/drawer/drawer.tsx"],"sourcesContent":["import { onBeforeUnmount, onMounted, computed, defineComponent, nextTick, onUpdated, ref, watch, Teleport } from 'vue';\nimport { CloseIcon as TdCloseIcon } from 'tdesign-icons-vue-next';\nimport { useConfig, usePrefixClass } from '../hooks/useConfig';\nimport { useGlobalIcon } from '../hooks/useGlobalIcon';\nimport { isServer } from '../utils/dom';\nimport { getScrollbarWidth } from '@tdesign/common-js/utils/getScrollbarWidth';\nimport props from './props';\nimport { DrawerCloseContext } from './type';\nimport { useAction } from '../dialog/hooks';\nimport { useTNodeJSX, useContent } from '../hooks/tnode';\nimport { useDrag } from './hooks';\nimport type { TdDrawerProps } from './type';\nimport useTeleport from '../hooks/useTeleport';\n\nlet key = 1;\n\nexport default defineComponent({\n  name: 'TDrawer',\n  inheritAttrs: false,\n  props,\n  emits: ['update:visible'],\n  setup(props, context) {\n    const destroyOnCloseVisible = ref(false);\n    const isVisible = ref(false);\n    const styleEl = ref();\n    const styleTimer = ref();\n    const { globalConfig } = useConfig('drawer');\n    const { CloseIcon } = useGlobalIcon({ CloseIcon: TdCloseIcon });\n    const renderTNodeJSX = useTNodeJSX();\n    const renderContent = useContent();\n    const COMPONENT_NAME = usePrefixClass('drawer');\n    const { draggedSizeValue, enableDrag, draggableLineStyles, draggingStyles } = useDrag(props as TdDrawerProps);\n\n    // teleport容器\n    const teleportElement = useTeleport(() => props.attach);\n\n    const confirmBtnAction = (e: MouseEvent) => {\n      props.onConfirm?.({ e });\n    };\n    const cancelBtnAction = (e: MouseEvent) => {\n      props.onCancel?.({ e });\n      closeDrawer({ trigger: 'cancel', e });\n    };\n    const { getConfirmBtn, getCancelBtn } = useAction({ confirmBtnAction, cancelBtnAction });\n    const drawerEle = ref<HTMLElement | null>(null);\n    const drawerClasses = computed(() => {\n      return [\n        COMPONENT_NAME.value,\n        `${COMPONENT_NAME.value}--${props.placement}`,\n        {\n          [`${COMPONENT_NAME.value}--open`]: isVisible.value,\n          [`${COMPONENT_NAME.value}--attach`]: props.showInAttachedElement,\n          [`${COMPONENT_NAME.value}--without-mask`]: !props.showOverlay,\n        },\n        props?.drawerClassName,\n      ];\n    });\n\n    const sizeValue = computed(() => {\n      if (draggedSizeValue.value) return draggedSizeValue.value;\n\n      const size = props.size ?? globalConfig.value.size;\n      const defaultSize = isNaN(Number(size)) ? size : `${size}px`;\n      return (\n        {\n          small: '300px',\n          medium: '500px',\n          large: '760px',\n        }[size] || defaultSize\n      );\n    });\n    const wrapperStyles = computed(() => {\n      return {\n        // 用于抵消动画效果：transform: translateX(100%); 等\n        transform: isVisible.value ? 'translateX(0)' : undefined,\n        width: ['left', 'right'].includes(props.placement) ? sizeValue.value : '',\n        height: ['top', 'bottom'].includes(props.placement) ? sizeValue.value : '',\n      };\n    });\n\n    const wrapperClasses = computed(() => {\n      return [\n        `${COMPONENT_NAME.value}__content-wrapper`,\n        `${COMPONENT_NAME.value}__content-wrapper--${props.placement}`,\n      ];\n    });\n\n    const parentNode = computed<HTMLElement>(() => {\n      return drawerEle.value && (drawerEle.value.parentNode as HTMLElement);\n    });\n\n    const modeAndPlacement = computed<string>(() => {\n      return [props.mode, props.placement].join();\n    });\n\n    const footerStyle = computed(() => {\n      return {\n        display: 'flex',\n        justifyContent: props.placement === 'right' ? 'flex-start' : 'flex-end',\n      };\n    });\n\n    const handleEscKeydown = (e: KeyboardEvent) => {\n      if ((props.closeOnEscKeydown ?? globalConfig.value.closeOnEscKeydown) && e.key === 'Escape' && isVisible.value) {\n        props.onEscKeydown?.({ e });\n        closeDrawer({ trigger: 'esc', e });\n      }\n    };\n\n    const clearStyleFunc = () => {\n      clearTimeout(styleTimer.value);\n      styleTimer.value = setTimeout(() => {\n        styleEl.value?.parentNode?.removeChild?.(styleEl.value);\n      }, 150);\n    };\n\n    const handlePushMode = () => {\n      if (props.mode !== 'push') return;\n      nextTick(() => {\n        if (!parentNode.value) return;\n        parentNode.value.style.cssText = 'transition: margin 300ms cubic-bezier(0.7, 0.3, 0.1, 1) 0s;';\n      });\n    };\n    // push 动画效果处理\n    const updatePushMode = () => {\n      if (!parentNode.value) return;\n      if (props.mode !== 'push' || !parentNode.value) return;\n      const marginStr = {\n        left: `margin: 0 0 0 ${sizeValue.value}`,\n        right: `margin: 0 0 0 -${sizeValue.value}`,\n        top: `margin: ${sizeValue.value} 0 0 0`,\n        bottom: `margin: -${sizeValue.value} 0 0 0`,\n      }[props.placement];\n      if (isVisible.value) {\n        parentNode.value.style.cssText += marginStr;\n      } else {\n        parentNode.value.style.cssText = parentNode.value.style.cssText.replace(/margin:.+;/, '');\n      }\n    };\n\n    // locale 全局配置，插槽，props，默认值，决定了按钮最终呈现\n    const getDefaultFooter = () => {\n      // this.getConfirmBtn is a function of useAction\n      const confirmBtn = getConfirmBtn({\n        confirmBtn: props.confirmBtn as TdDrawerProps['confirmBtn'],\n        globalConfirm: globalConfig.value.confirm,\n        className: `${COMPONENT_NAME.value}__confirm`,\n      });\n      // this.getCancelBtn is a function of useAction\n      const cancelBtn = getCancelBtn({\n        cancelBtn: props.cancelBtn as TdDrawerProps['cancelBtn'],\n        globalCancel: globalConfig.value.cancel,\n        className: `${COMPONENT_NAME.value}__cancel`,\n      });\n      return (\n        <div style={footerStyle.value}>\n          {props.placement === 'right' ? confirmBtn : null}\n          {cancelBtn}\n          {props.placement !== 'right' ? confirmBtn : null}\n        </div>\n      );\n    };\n    watch(\n      modeAndPlacement,\n      () => {\n        handlePushMode();\n      },\n      { immediate: true },\n    );\n    watch(\n      () => props.visible,\n      (value) => {\n        if (isServer) return;\n        if (value) {\n          if (!props.showInAttachedElement && props.preventScrollThrough) {\n            styleEl.value && document.head.appendChild(styleEl.value);\n          }\n        } else {\n          clearStyleFunc();\n        }\n\n        // 打开前动画或关闭前动画\n        value ? props.onBeforeOpen?.() : props.onBeforeClose?.();\n\n        // 处理显示逻辑\n        if (props.destroyOnClose) {\n          if (value) {\n            destroyOnCloseVisible.value = false;\n            setTimeout(() => {\n              isVisible.value = true;\n            });\n          } else {\n            isVisible.value = false;\n            setTimeout(() => {\n              destroyOnCloseVisible.value = true;\n            }, 200);\n          }\n        } else if (destroyOnCloseVisible.value === true && value) {\n          destroyOnCloseVisible.value = false;\n          setTimeout(() => {\n            isVisible.value = true;\n          });\n        } else {\n          setTimeout(() => {\n            isVisible.value = value;\n          });\n        }\n      },\n      { immediate: true },\n    );\n    const handleCloseBtnClick = (e: MouseEvent) => {\n      props.onCloseBtnClick?.({ e });\n      closeDrawer({ trigger: 'close-btn', e });\n    };\n    const handleWrapperClick = (e: MouseEvent) => {\n      props.onOverlayClick?.({ e });\n      if (props.closeOnOverlayClick ?? globalConfig.value.closeOnOverlayClick) {\n        closeDrawer({ trigger: 'overlay', e });\n      }\n    };\n\n    const closeDrawer = (params: DrawerCloseContext) => {\n      props.onClose?.(params);\n      context.emit('update:visible', false);\n    };\n\n    onUpdated(() => {\n      updatePushMode();\n    });\n\n    onMounted(() => {\n      const hasScrollBar = window.innerWidth > document.documentElement.clientWidth;\n      const scrollWidth = hasScrollBar ? getScrollbarWidth() : 0;\n\n      styleEl.value = document.createElement('style');\n      styleEl.value.dataset.id = `td_drawer_${+new Date()}_${(key += 1)}`;\n      styleEl.value.innerHTML = `\n        html body {\n          overflow-y: hidden;\n          transition: margin 300ms cubic-bezier(0.7, 0.3, 0.1, 1) 0s;\n          ${props.mode === 'push' ? '' : `width: calc(100% - ${scrollWidth}px);`}\n        }\n      `;\n\n      if (isVisible.value && !props.showInAttachedElement && props.preventScrollThrough) {\n        document.head.appendChild(styleEl.value);\n      }\n\n      window.addEventListener('keydown', handleEscKeydown);\n    });\n\n    onBeforeUnmount(() => {\n      clearStyleFunc();\n      window.removeEventListener('keydown', handleEscKeydown);\n    });\n\n    return () => {\n      if (destroyOnCloseVisible.value) return;\n      const body = renderContent('body', 'default');\n      const headerContent = renderTNodeJSX('header');\n      const defaultFooter = getDefaultFooter();\n\n      return (\n        <Teleport disabled={!props.attach || !teleportElement.value} to={teleportElement.value}>\n          <div\n            ref={drawerEle}\n            class={drawerClasses.value}\n            style={{ zIndex: props.zIndex }}\n            onKeydown={handleEscKeydown}\n            tabindex={0}\n            {...context.attrs}\n          >\n            {props.showOverlay && <div class={`${COMPONENT_NAME.value}__mask`} onClick={handleWrapperClick} />}\n            <div class={wrapperClasses.value} style={{ ...wrapperStyles.value, ...draggingStyles.value }}>\n              {headerContent && <div class={`${COMPONENT_NAME.value}__header`}>{headerContent}</div>}\n              {props.closeBtn && (\n                <div class={`${COMPONENT_NAME.value}__close-btn`} onClick={handleCloseBtnClick}>\n                  {renderTNodeJSX('closeBtn', <CloseIcon />)}\n                </div>\n              )}\n              <div class={[`${COMPONENT_NAME.value}__body`, 'narrow-scrollbar']}>{body}</div>\n              {props.footer && (\n                <div class={`${COMPONENT_NAME.value}__footer`}>{renderTNodeJSX('footer', defaultFooter)}</div>\n              )}\n              {props.sizeDraggable && <div style={draggableLineStyles.value} onMousedown={enableDrag}></div>}\n            </div>\n          </div>\n        </Teleport>\n      );\n    };\n  },\n});\n"],"names":["key","defineComponent","name","inheritAttrs","props","emits","setup","context","destroyOnCloseVisible","ref","isVisible","styleEl","styleTimer","_useConfig","useConfig","globalConfig","_useGlobalIcon","useGlobalIcon","CloseIcon","TdCloseIcon","renderTNodeJSX","useTNodeJSX","renderContent","useContent","COMPONENT_NAME","usePrefixClass","_useDrag","useDrag","draggedSizeValue","enableDrag","draggableLineStyles","draggingStyles","teleportElement","useTeleport","attach","confirmBtnAction","e","_props2$onConfirm","onConfirm","cancelBtnAction","_props2$onCancel","onCancel","closeDrawer","trigger","_useAction","useAction","getConfirmBtn","getCancelBtn","drawerEle","drawerClasses","computed","value","concat","placement","_defineProperty","showInAttachedElement","showOverlay","drawerClassName","sizeValue","_props2$size","size","defaultSize","isNaN","Number","small","medium","large","wrapperStyles","transform","width","includes","height","wrapperClasses","parentNode","modeAndPlacement","mode","join","footerStyle","display","justifyContent","handleEscKeydown","_props2$closeOnEscKey","closeOnEscKeydown","_props2$onEscKeydown","onEscKeydown","clearStyleFunc","clearTimeout","setTimeout","_styleEl$value","_styleEl$value$remove","removeChild","call","handlePushMode","nextTick","style","cssText","updatePushMode","marginStr","left","right","top","bottom","replace","getDefaultFooter","confirmBtn","globalConfirm","confirm","className","cancelBtn","globalCancel","cancel","_createVNode","watch","immediate","visible","_props2$onBeforeOpen","_props2$onBeforeClose","isServer","preventScrollThrough","document","head","appendChild","onBeforeOpen","onBeforeClose","destroyOnClose","handleCloseBtnClick","_props2$onCloseBtnCli","onCloseBtnClick","handleWrapperClick","_props2$onOverlayClic","_props2$closeOnOverla","onOverlayClick","closeOnOverlayClick","params","_props2$onClose","onClose","emit","onUpdated","onMounted","hasScrollBar","window","innerWidth","documentElement","clientWidth","scrollWidth","getScrollbarWidth","createElement","dataset","id","Date","innerHTML","addEventListener","onBeforeUnmount","removeEventListener","body","headerContent","defaultFooter","Teleport","_default","_mergeProps","zIndex","attrs","_objectSpread","closeBtn","footer","sizeDraggable"],"mappings":"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"}