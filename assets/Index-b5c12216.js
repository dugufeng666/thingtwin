import{f as e,S as a,d as t,j as l,s as n,r as o,o as i,U as d,V as r,k as s,W as u,E as m,G as c,X as g,F as v,J as f,Y as h,Z as p,c as w,_ as b,$ as x,w as _,u as k,a0 as C,K as y}from"./vue-vendor-c67988ac.js";import{c as V,g as S,d as A,P as U}from"./meta2d-dfafba89.js";import{M as L,_ as R}from"./index-ca1feb0b.js";import{u as E,S as P,V as O}from"./View-cbb04a97.js";var j,N={exports:{}};j=N,function(){function e(e,a){return void 0===a?a={autoBom:!1}:"object"!=typeof a&&(a={autoBom:!a}),a.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}function a(e,a,t){var l=new XMLHttpRequest;l.open("GET",e),l.responseType="blob",l.onload=function(){i(l.response,a,t)},l.onerror=function(){},l.send()}function t(e){var a=new XMLHttpRequest;a.open("HEAD",e,!1);try{a.send()}catch(t){}return 200<=a.status&&299>=a.status}function l(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(t){var a=document.createEvent("MouseEvents");a.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(a)}}var n="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof V&&V.global===V?V:void 0,o=n.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),i=n.saveAs||("object"!=typeof window||window!==n?function(){}:"download"in HTMLAnchorElement.prototype&&!o?function(e,o,i){var d=n.URL||n.webkitURL,r=document.createElement("a");o=o||e.name||"download",r.download=o,r.rel="noopener","string"==typeof e?(r.href=e,r.origin===location.origin?l(r):t(r.href)?a(e,o,i):l(r,r.target="_blank")):(r.href=d.createObjectURL(e),setTimeout((function(){d.revokeObjectURL(r.href)}),4e4),setTimeout((function(){l(r)}),0))}:"msSaveOrOpenBlob"in navigator?function(n,o,i){if(o=o||n.name||"download","string"!=typeof n)navigator.msSaveOrOpenBlob(e(n,i),o);else if(t(n))a(n,o,i);else{var d=document.createElement("a");d.href=n,d.target="_blank",setTimeout((function(){l(d)}))}}:function(e,t,l,i){if((i=i||open("","_blank"))&&(i.document.title=i.document.body.innerText="downloading..."),"string"==typeof e)return a(e,t,l);var d="application/octet-stream"===e.type,r=/constructor/i.test(n.HTMLElement)||n.safari,s=/CriOS\/[\d]+/.test(navigator.userAgent);if((s||d&&r||o)&&"undefined"!=typeof FileReader){var u=new FileReader;u.onloadend=function(){var e=u.result;e=s?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),i?i.location.href=e:location=e,i=null},u.readAsDataURL(e)}else{var m=n.URL||n.webkitURL,c=m.createObjectURL(e);i?i.location=c:location.href=c,i=null,setTimeout((function(){m.revokeObjectURL(c)}),4e4)}});n.saveAs=i.saveAs=i,j.exports=i}();const T=S(N.exports),D={class:"app-header"},M={class:"app-header"},B={class:"l-icon","aria-hidden":"true"},H=["xlink:href"],I=["onClick"],F={class:"l-icon","aria-hidden":"true"},z=["xlink:href"],J={class:"l-icon","aria-hidden":"true"},W=["xlink:href"],G=["onClick"],X={class:"l-icon","aria-hidden":"true"},$=["xlink:href"],q={class:"l-icon","aria-hidden":"true"},Y=["xlink:href"],K=["onClick"],Z={class:"l-icon","aria-hidden":"true"},Q=["xlink:href"],ee=R(e({__name:"Header",setup(e){const b=a(),x=t(!1),_=t(0);l((()=>{const e=setInterval((()=>{meta2d&&(clearInterval(e),k(meta2d.store.data.scale),meta2d.on("scale",k))}),200)}));const k=e=>{_.value=Math.round(100*e)},C=()=>{x.value?(x.value=!1,meta2d.finishDrawLine(),meta2d.drawLine(),meta2d.store.options.disableAnchor=!0):(x.value=!0,meta2d.drawLine(meta2d.store.options.drawingLineName),meta2d.store.options.disableAnchor=!1)},y=n([{name:"曲线",icon:"#l-curve2",value:"curve"},{name:"线段",icon:"#l-polyline",value:"polyline"},{name:"直线",icon:"#l-line",value:"line"},{name:"脑图曲线",icon:"#l-mind",value:"mind"}]),V=t("curve"),S=t(""),R=[{icon:"#l-line",value:""},{icon:"#l-from-triangle",value:"triangle"},{icon:"#l-from-diamond",value:"diamond"},{icon:"#l-from-circle",value:"circle"},{icon:"#l-from-lineDown",value:"lineDown"},{icon:"#l-from-lineUp",value:"lineUp"},{icon:"#l-from-triangleSolid",value:"triangleSolid"},{icon:"#l-from-diamondSolid",value:"diamondSolid"},{icon:"#l-from-circleSolid",value:"circleSolid"},{icon:"#l-from-line",value:"line"}],E=t(""),P=[{icon:"#l-line",value:""},{icon:"#l-to-triangle",value:"triangle"},{icon:"#l-to-diamond",value:"diamond"},{icon:"#l-to-circle",value:"circle"},{icon:"#l-to-lineDown",value:"lineDown"},{icon:"#l-to-lineUp",value:"lineUp"},{icon:"#l-to-triangleSolid",value:"triangleSolid"},{icon:"#l-to-diamondSolid",value:"diamondSolid"},{icon:"#l-to-circleSolid",value:"circleSolid"},{icon:"#l-to-line",value:"line"}],O=()=>{meta2d.open({name:"新建项目",pens:[]})};const j=()=>{const e=document.createElement("input");e.type="file",e.onchange=async e=>{const a=e.target;if(a.files&&a.files[0]){const e=await(t=a.files[0],new Promise(((e,a)=>{const l=new FileReader;l.onload=()=>{e(l.result)},l.onerror=a,l.readAsText(t)})));try{meta2d.open(JSON.parse(e)),meta2d.fitView()}catch(l){}}var t},e.click()},N=()=>{const e=meta2d.data();T.saveAs(new Blob([JSON.stringify(e)],{type:"text/plain;charset=utf-8"}),`${e.name||"le5le.meta2d"}.json`)},ee=()=>{let e=meta2d.store.data.name;e&&(e+=".png"),meta2d.downloadPng(e)};function ae(e,a){var t;let l=e;for(;l&&l.parentId;){const e=l;l=a.pens[l.parentId];const n=null==(t=null==l?void 0:l.calculative)?void 0:t.showChild;if(null!=n){if(l.children[n]!==e.id)return!1}}return!0}const te=()=>{if(!C2S)return void L.error("请先加载乐吾乐官网下的canvas2svg.js");const e=meta2d.getRect();e.x-=10,e.y-=10;const a=new C2S(e.width+20,e.height+20);a.textBaseline="middle";for(const r of meta2d.store.data.pens)0!=r.visible&&ae(r,meta2d.store)&&meta2d.renderPenRaw(a,r,e);let t=a.getSerializedSvg();meta2d.store.data.background?(t=t.replace("{{bk}}",""),t=t.replace("{{bkRect}}",`<rect x="0" y="0" width="100%" height="100%" fill="${meta2d.store.data.background}"></rect>`)):(t=t.replace("{{bk}}",""),t=t.replace("{{bkRect}}","")),t=t.replace(/--le5le--/g,"&#x");const l=window.URL||window,n=new Blob([t]),o=l.createObjectURL(n),i=document.createElement("a");i.setAttribute("download",`${meta2d.store.data.name||"le5le.meta2d"}.svg`),i.setAttribute("href",o);const d=document.createEvent("MouseEvents");d.initEvent("click",!0,!0),i.dispatchEvent(d)},le=()=>{meta2d.undo()},ne=()=>{meta2d.redo()},oe=()=>{meta2d.cut()},ie=()=>{meta2d.copy()},de=()=>{meta2d.paste()},re=()=>{meta2d.activeAll()},se=()=>{meta2d.delete()},ue=(e,a)=>{var t;let l;e.stopPropagation(),"text"===a?l={text:"text",width:100,height:20,name:"text"}:"line"===a&&(l={anchors:[{id:"0",x:1,y:0},{id:"1",x:0,y:1}],width:100,height:100,name:"line",lineName:"line",type:1}),e.dataTransfer?null==(t=e.dataTransfer)||t.setData("Meta2d",JSON.stringify(l)):meta2d.canvas.addCaches=A([l])},me=()=>{meta2d.scale(1),meta2d.centerView()},ce=()=>{meta2d.fitView()},ge=()=>{meta2d.stopAnimate();const e=meta2d.data();localStorage.setItem("meta2d",JSON.stringify(e)),b.push({path:"/preview",query:{r:Date.now()+"",id:e._id}})};return(e,a)=>{const t=o("t-dropdown"),l=o("t-dropdown-item"),n=o("t-dropdown-menu"),b=o("t-tooltip"),k=o("t-icon");return i(),d(v,null,[r("div",D,[s(t,{minColumnWidth:200,maxHeight:560,overlayClassName:"header-dropdown"},{default:u((()=>a[4]||(a[4]=[r("span",null,"数字孪生编辑器",-1)]))),_:1,__:[4]}),s(t,{minColumnWidth:200,maxHeight:560,overlayClassName:"header-dropdown"},{default:u((()=>[a[7]||(a[7]=r("a",null," 文件 ",-1)),s(n,null,{default:u((()=>[s(l,{onClick:O},{default:u((()=>a[5]||(a[5]=[r("a",null,"新建文件",-1)]))),_:1,__:[5]}),s(l,{onClick:j,divider:"true"},{default:u((()=>a[6]||(a[6]=[r("a",null,"打开文件",-1)]))),_:1,__:[6]}),s(l,{divider:"true"},{default:u((()=>[r("a",{onClick:N},"下载JSON文件")])),_:1}),s(l,null,{default:u((()=>[r("a",{onClick:ee},"下载为PNG")])),_:1}),s(l,null,{default:u((()=>[r("a",{onClick:te},"下载为SVG")])),_:1})])),_:1})])),_:1,__:[7]}),s(t,{minColumnWidth:180,maxHeight:500,overlayClassName:"header-dropdown"},{default:u((()=>[a[15]||(a[15]=r("a",null," 编辑 ",-1)),s(n,null,{default:u((()=>[s(l,null,{default:u((()=>[r("a",{onClick:le},a[8]||(a[8]=[r("div",{class:"flex"},[f(" 撤销 "),r("span",{class:"flex-grow"}),f(" Ctrl + Z ")],-1)]))])),_:1}),s(l,{divider:"true"},{default:u((()=>[r("a",{onClick:ne},a[9]||(a[9]=[r("div",{class:"flex"},[f(" 恢复 "),r("span",{class:"flex-grow"}),f(" Ctrl + Y ")],-1)]))])),_:1}),s(l,null,{default:u((()=>[r("a",{onClick:oe},a[10]||(a[10]=[r("div",{class:"flex"},[f(" 剪切 "),r("span",{class:"flex-grow"}),f(" Ctrl + X ")],-1)]))])),_:1}),s(l,null,{default:u((()=>[r("a",{onClick:ie},a[11]||(a[11]=[r("div",{class:"flex"},[f(" 复制 "),r("span",{class:"flex-grow"}),f(" Ctrl + C ")],-1)]))])),_:1}),s(l,{divider:"true"},{default:u((()=>[r("a",{onClick:de},a[12]||(a[12]=[r("div",{class:"flex"},[f(" 粘贴 "),r("span",{class:"flex-grow"}),f(" Ctrl + V ")],-1)]))])),_:1}),s(l,null,{default:u((()=>[r("a",{onClick:re},a[13]||(a[13]=[r("div",{class:"flex"},[f(" 全选 "),r("span",{class:"flex-grow"}),f(" Ctrl + A ")],-1)]))])),_:1}),s(l,null,{default:u((()=>[r("a",{onClick:se},a[14]||(a[14]=[r("div",{class:"flex"},[f("删除 "),r("span",{class:"flex-grow"}),f(" DELETE")],-1)]))])),_:1})])),_:1})])),_:1,__:[15]})]),r("div",M,[s(b,{content:"撤销"},{default:u((()=>[(i(),d("svg",{class:"l-icon","aria-hidden":"true",onClick:le},a[16]||(a[16]=[r("use",{"xlink:href":"#l-undo"},null,-1)])))])),_:1}),s(b,{content:"重做"},{default:u((()=>[(i(),d("svg",{class:"l-icon","aria-hidden":"true",onClick:ne},a[17]||(a[17]=[r("use",{"xlink:href":"#l-redo"},null,-1)])))])),_:1}),s(b,{content:"直线"},{default:u((()=>[r("span",{draggable:!0,onDragstart:a[0]||(a[0]=e=>ue(e,"line")),onClick:a[1]||(a[1]=e=>ue(e,"line"))},[s(k,{name:"slash"})],32)])),_:1}),s(b,{content:"文字"},{default:u((()=>[r("span",{draggable:!0,onDragstart:a[2]||(a[2]=e=>ue(e,"text")),onClick:a[3]||(a[3]=e=>ue(e,"text"))},a[18]||(a[18]=[r("svg",{class:"l-icon","aria-hidden":"true"},[r("use",{"xlink:href":"#l-text"})],-1)]),32)])),_:1}),s(b,{content:"连线"},{default:u((()=>[(i(),d("svg",{width:"1em",height:"1em",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg",onClick:C,style:h({color:x.value?" #1677ff":""})},a[19]||(a[19]=[r("path",{d:"M192 64a128 128 0 0 1 123.968 96H384a160 160 0 0 1 159.68 149.504L544 320v384a96 96 0 0 0 86.784 95.552L640 800h68.032a128 128 0 1 1 0 64.064L640 864a160 160 0 0 1-159.68-149.504L480 704V320a96 96 0 0 0-86.784-95.552L384 224l-68.032 0.064A128 128 0 1 1 192 64z m640 704a64 64 0 1 0 0 128 64 64 0 0 0 0-128zM192 128a64 64 0 1 0 0 128 64 64 0 0 0 0-128z",fill:"currentColor"},null,-1)]),4))])),_:1}),s(t,{minColumnWidth:160,maxHeight:560,overlayClassName:"header-dropdown"},{default:u((()=>{var e;return[r("a",null,[(i(),d("svg",B,[r("use",{"xlink:href":null==(e=y.find((e=>e.value===V.value)))?void 0:e.icon},null,8,H)]))]),s(n,null,{default:u((()=>[(i(!0),d(v,null,p(y,(e=>(i(),w(l,null,{default:u((()=>[r("div",{class:"flex middle",onClick:a=>(e=>{var a;V.value=e,meta2d&&(meta2d.store.options.drawingLineName=e,meta2d.canvas.drawingLineName&&(meta2d.canvas.drawingLineName=e),null==(a=meta2d.store.active)||a.forEach((a=>{meta2d.updateLineType(a,e)})))})(e.value)},[f(g(e.name)+" ",1),a[20]||(a[20]=r("span",{class:"flex-grow"},null,-1)),(i(),d("svg",F,[r("use",{"xlink:href":e.icon},null,8,z)]))],8,I)])),_:2},1024)))),256))])),_:1})]})),_:1}),s(t,{minColumnWidth:160,maxHeight:560,delay2:[10,150],overlayClassName:"header-dropdown"},{default:u((()=>{var e;return[r("a",null,[(i(),d("svg",J,[r("use",{"xlink:href":null==(e=R.find((e=>e.value===S.value)))?void 0:e.icon},null,8,W)]))]),s(n,null,{default:u((()=>[(i(),d(v,null,p(R,(e=>s(l,null,{default:u((()=>[r("div",{class:"flex middle",style:{height:"30px"},onClick:a=>{return t=e.value,S.value=t,meta2d.store.data.fromArrow=t,void(meta2d.store.active&&(meta2d.store.active.forEach((e=>{e.type===U.Line&&(e.fromArrow=t,meta2d.setValue({id:e.id,fromArrow:e.fromArrow},{render:!1}))})),meta2d.render()));var t}},[(i(),d("svg",X,[r("use",{"xlink:href":e.icon},null,8,$)]))],8,G)])),_:2},1024))),64))])),_:1})]})),_:1}),s(t,{minColumnWidth:160,maxHeight:560,delay2:[10,150],overlayClassName:"header-dropdown"},{default:u((()=>{var e;return[r("a",null,[(i(),d("svg",q,[r("use",{"xlink:href":null==(e=P.find((e=>e.value===E.value)))?void 0:e.icon},null,8,Y)]))]),s(n,null,{default:u((()=>[(i(),d(v,null,p(P,(e=>s(l,null,{default:u((()=>[r("div",{class:"flex middle",style:{height:"30px"},onClick:a=>{return t=e.value,E.value=t,meta2d.store.data.toArrow=t,void(meta2d.store.active&&(meta2d.store.active.forEach((e=>{e.type===U.Line&&(e.toArrow=t,meta2d.setValue({id:e.id,toArrow:e.toArrow},{render:!1}))})),meta2d.render()));var t}},[(i(),d("svg",Z,[r("use",{"xlink:href":e.icon},null,8,Q)]))],8,K)])),_:2},1024))),64))])),_:1})]})),_:1}),a[21]||(a[21]=r("div",{style:{width:"64px"}},null,-1)),m(r("div",{style:{"line-height":"40px"}},g(_.value)+"%",513),[[c,_.value>0]]),s(b,{content:"100%视图",placement:"bottom"},{default:u((()=>[r("a",{onClick:me},[s(k,{name:"refresh"})])])),_:1}),s(b,{content:"窗口大小",placement:"bottom"},{default:u((()=>[r("a",{onClick:ce,style:{"margin-left":"-16px"}},[s(k,{name:"fullscreen-exit"})])])),_:1}),a[22]||(a[22]=r("div",{style:{width:"36px"}},null,-1)),s(b,{content:"运行查看"},{default:u((()=>[s(k,{name:"play-circle-stroke",onClick:ge})])),_:1})])],64)}}}),[["__scopeId","data-v-179e987c"]]),ae={class:"graphics"},te=["onDragstart","onClick"],le=["src","alt"],ne=["title"],oe=R(e({__name:"Graphics",setup(e){const a=[{name:"设备",show:!0,list:[{name:"分集水器",icon:"l-device-separator",id:"device_1",data:{width:100,height:40,name:"image",text:"分集水器",image:"/devices/separator.svg",textPosition:"bottom",textColor:"#fff"}},{name:"加药泵",icon:"l-device-pump",id:"device_2",data:{width:40,height:80,name:"image",text:"加药泵",image:"/devices/pump.svg",textPosition:"bottom",textColor:"#fff"}},{name:"加药箱",icon:"l-device-tank",id:"device_3",data:{width:60,height:100,name:"image",text:"加药箱",image:"/devices/tank.svg",textPosition:"bottom",textColor:"#fff"}},{name:"加药箱2",icon:"l-device-tank2",id:"device_4",data:{width:60,height:100,name:"image",text:"加药箱2",image:"/devices/tank2.svg",textPosition:"bottom",textColor:"#fff"}},{name:"压力表",icon:"l-device-gauge",id:"device_5",data:{width:60,height:60,name:"image",text:"压力表",image:"/devices/gauge.svg",textPosition:"bottom",textColor:"#fff"}},{name:"压滤机",icon:"l-device-filter",id:"device_6",data:{width:120,height:40,name:"image",text:"压滤机",image:"/devices/filter.svg",textPosition:"bottom",textColor:"#fff"}},{name:"回流泵",icon:"l-device-pump2",id:"device_7",data:{width:80,height:40,name:"image",text:"回流泵",image:"/devices/pump2.svg",textPosition:"bottom",textColor:"#fff"}},{name:"废水池",icon:"l-device-pool",id:"device_8",data:{width:120,height:120,name:"image",text:"废水池",image:"/devices/pool.svg",textPosition:"bottom",textColor:"#fff"}},{name:"排水泵",icon:"l-device-drain",id:"device_9",data:{width:80,height:40,name:"image",text:"排水泵",image:"/devices/drain.svg",textPosition:"bottom",textColor:"#fff"}},{name:"污泥收集",icon:"l-device-sludge",id:"device_10",data:{width:120,height:120,name:"image",text:"污泥收集",image:"/devices/sludge.svg",textPosition:"bottom",textColor:"#fff"}},{name:"污泥泵",icon:"l-device-sludge-pump",id:"device_11",data:{width:40,height:100,name:"image",text:"污泥泵",image:"/devices/sludge-pump.svg",textPosition:"bottom",textColor:"#fff"}},{name:"沉淀池",icon:"l-device-settling",id:"device_12",data:{width:150,height:150,name:"image",text:"沉淀池",image:"/devices/settling.svg",textPosition:"bottom",textColor:"#fff"}}]},{name:"基本形状",show:!0,list:[{name:"正方形",icon:"l-rect",id:1,data:{width:100,height:100,name:"rectangle",strokeStyle:"rgb(0, 31, 151)"}},{name:"矩形",icon:"l-rectangle",id:2,data:{width:200,height:50,name:"rectangle",borderRadius:.1,strokeStyle:"rgb(0, 31, 151)"}},{name:"圆",icon:"l-circle",id:3,data:{width:100,height:100,name:"circle",strokeStyle:"rgb(0, 31, 151)"}},{name:"三角形",icon:"l-triangle",id:4,data:{width:100,height:100,name:"triangle",strokeStyle:"rgb(0, 31, 151)"}},{name:"菱形",icon:"l-diamond",id:5,data:{width:100,height:100,name:"diamond",strokeStyle:"rgb(0, 31, 151)"}},{name:"五边形",icon:"l-pentagon",id:6,data:{width:100,height:100,name:"pentagon",strokeStyle:"rgb(0, 31, 151)"}},{name:"六边形",icon:"l-hexagon",id:7,data:{width:100,height:100,name:"hexagon",strokeStyle:"rgb(0, 31, 151)"}},{name:"五角星",icon:"l-pentagram",id:8,data:{width:100,height:100,name:"pentagram",strokeStyle:"rgb(0, 31, 151)"}},{name:"左箭头",icon:"l-arrow-left",id:9,data:{width:120,height:60,name:"leftArrow",strokeStyle:"rgb(0, 31, 151)"}},{name:"右箭头",icon:"l-arrow-right",id:10,data:{width:120,height:60,name:"rightArrow",strokeStyle:"rgb(0, 31, 151)"}},{name:"双向箭头",icon:"l-twoway-arrow",id:11,data:{width:150,height:60,name:"twowayArrow",strokeStyle:"rgb(0, 31, 151)"}},{name:"云",icon:"l-cloud",id:13,data:{width:100,height:100,name:"cloud",strokeStyle:"rgb(0, 31, 151)"}},{name:"消息框",icon:"l-msg",id:14,data:{width:100,height:100,name:"message",textTop:-.1,strokeStyle:"rgb(0, 31, 151)"}},{name:"文件",icon:"l-file",id:15,data:{width:80,height:100,name:"file",strokeStyle:"rgb(0, 31, 151)"}},{name:"立方体",icon:"l-cube",id:18,data:{width:100,height:100,name:"cube",strokeStyle:"rgb(0, 31, 151)"}},{name:"人",icon:"l-people",id:19,data:{width:70,height:100,name:"people",strokeStyle:"rgb(0, 31, 151)"}}]}],t=(e,a)=>{var t;a&&(e.stopPropagation(),e instanceof DragEvent?null==(t=e.dataTransfer)||t.setData("Meta2d",JSON.stringify(a.data)):meta2d.canvas.addCaches=[a.data])};return(e,l)=>{const n=o("t-collapse-panel"),m=o("t-collapse");return i(),d("div",ae,[s(m,{defaultExpandAll:!0},{default:u((()=>[(i(),d(v,null,p(a,(e=>s(n,{header:e.name,key:e.name},{default:u((()=>[(i(!0),d(v,null,p(e.list,(e=>(i(),d("div",{class:"graphic",draggable:!0,onDragstart:a=>t(a,e),onClick:b((a=>t(a,e)),["prevent"])},[e.data.image?(i(),d("img",{key:0,src:e.data.image,alt:e.name,class:"l-icon"},null,8,le)):(i(),d("div",{key:1,class:x([e.icon,"l-icon"])},null,2)),r("p",{title:e.name},g(e.name),9,ne)],40,te)))),256))])),_:2},1032,["header"]))),64))])),_:1})])}}}),[["__scopeId","data-v-2987cd6a"]]),ie={class:"props-panel"},de=R(e({__name:"FileProps",setup(e){const a=n({name:"",background:void 0,color:void 0}),t=n({grid:!1,gridSize:10,gridRotate:void 0,gridColor:void 0,rule:!0});l((()=>{const e=meta2d.data();a.name=e.name||"",a.background=e.background,a.color=e.color,Object.assign(t,meta2d.getOptions())}));const m=()=>{Object.assign(meta2d.store.data,a),meta2d.store.patchFlagsBackground=!0,meta2d.render()},c=()=>{meta2d.setOptions(t),meta2d.store.patchFlagsTop=!0,meta2d.store.patchFlagsBackground=!0,meta2d.render()};return(e,l)=>{const n=o("t-input"),g=o("t-form-item"),v=o("t-divider"),f=o("t-switch"),h=o("t-color-picker"),p=o("t-form");return i(),d("div",ie,[s(p,{"label-align":"left"},{default:u((()=>[l[8]||(l[8]=r("h5",{class:"mb-24"},"图纸",-1)),s(g,{label:"图纸名称",name:"name"},{default:u((()=>[s(n,{modelValue:a.name,"onUpdate:modelValue":l[0]||(l[0]=e=>a.name=e),onChange:m},null,8,["modelValue"])])),_:1}),s(v),s(g,{label:"网格",name:"grid"},{default:u((()=>[s(f,{modelValue:t.grid,"onUpdate:modelValue":l[1]||(l[1]=e=>t.grid=e),onChange:c},null,8,["modelValue"])])),_:1}),s(g,{label:"网格大小",name:"gridSize"},{default:u((()=>[s(n,{modelValue:t.gridSize,"onUpdate:modelValue":l[2]||(l[2]=e=>t.gridSize=e),modelModifiers:{number:!0},onChange:c},null,8,["modelValue"])])),_:1}),s(g,{label:"网格角度",name:"gridRotate"},{default:u((()=>[s(n,{modelValue:t.gridRotate,"onUpdate:modelValue":l[3]||(l[3]=e=>t.gridRotate=e),modelModifiers:{number:!0},onChange:c},null,8,["modelValue"])])),_:1}),s(g,{label:"网格颜色",name:"gridColor"},{default:u((()=>[s(h,{class:"w-full",modelValue:t.gridColor,"onUpdate:modelValue":l[4]||(l[4]=e=>t.gridColor=e),"show-primary-color-preview":!1,format:"CSS","color-modes":["monochrome"],onChange:c},null,8,["modelValue"])])),_:1}),s(v),s(g,{label:"标尺",name:"rule"},{default:u((()=>[s(f,{modelValue:t.rule,"onUpdate:modelValue":l[5]||(l[5]=e=>t.rule=e),onChange:c},null,8,["modelValue"])])),_:1}),s(v),s(g,{label:"背景颜色",name:"background"},{default:u((()=>[s(h,{class:"w-full",modelValue:a.background,"onUpdate:modelValue":l[6]||(l[6]=e=>a.background=e),"show-primary-color-preview":!1,format:"CSS","color-modes":["monochrome"],onChange:m},null,8,["modelValue"])])),_:1}),s(g,{label:"图元默认颜色",name:"color"},{default:u((()=>[s(h,{class:"w-full",modelValue:a.color,"onUpdate:modelValue":l[7]||(l[7]=e=>a.color=e),"show-primary-color-preview":!1,format:"CSS","color-modes":["monochrome"],onChange:m},null,8,["modelValue"])])),_:1})])),_:1,__:[8]})])}}}),[["__scopeId","data-v-cfef9ece"]]),re={class:"props-panel"},se={class:"ml-16",style:{width:"50px","line-height":"30px"}},ue=R(e({__name:"PenProps",setup(e){const{selections:a}=E(),n=t(),m=t();l((()=>{c()}));const c=()=>{n.value=a.pen,null==n.value.globalAlpha&&(n.value.globalAlpha=1),m.value=meta2d.getPenRect(n.value)},v=_((()=>a.pen.id),c),h=[void 0,[5,5]],p=e=>{const a={id:n.value.id};a[e]=n.value[e],"dash"===e&&(a.lineDash=h[a[e]]),meta2d.setValue(a,{render:!0})},b=e=>{const a={id:n.value.id};a[e]=m.value[e],meta2d.setValue(a,{render:!0})},x=()=>{meta2d.top(),meta2d.render()},y=()=>{meta2d.bottom(),meta2d.render()},V=()=>{meta2d.up(),meta2d.render()},S=()=>{meta2d.down(),meta2d.render()};return k((()=>{v()})),(e,a)=>{const t=o("t-input"),l=o("t-form-item"),c=o("t-color-picker"),v=o("t-option"),h=o("t-select"),_=o("t-input-number"),k=o("t-slider"),A=o("t-divider"),U=o("t-button"),L=o("t-space"),R=o("t-form");return i(),d("div",re,[n.value?(i(),w(R,{key:0,"label-align":"left"},{default:u((()=>[a[28]||(a[28]=r("h5",{class:"mb-24"},"图元",-1)),s(l,{label:"文本",name:"text"},{default:u((()=>[s(t,{modelValue:n.value.text,"onUpdate:modelValue":a[0]||(a[0]=e=>n.value.text=e),onChange:a[1]||(a[1]=e=>p("text"))},null,8,["modelValue"])])),_:1}),s(l,{label:"颜色",name:"color"},{default:u((()=>[s(c,{class:"w-full",modelValue:n.value.color,"onUpdate:modelValue":a[2]||(a[2]=e=>n.value.color=e),"show-primary-color-preview":!1,format:"CSS","color-modes":["monochrome"],onChange:a[3]||(a[3]=e=>p("color"))},null,8,["modelValue"])])),_:1}),s(l,{label:"背景",name:"background"},{default:u((()=>[s(c,{class:"w-full",modelValue:n.value.background,"onUpdate:modelValue":a[4]||(a[4]=e=>n.value.background=e),"show-primary-color-preview":!1,format:"CSS","color-modes":["monochrome"],onChange:a[5]||(a[5]=e=>p("background"))},null,8,["modelValue"])])),_:1}),s(l,{label:"线条",name:"dash"},{default:u((()=>[s(h,{modelValue:n.value.dash,"onUpdate:modelValue":a[6]||(a[6]=e=>n.value.dash=e),onChange:a[7]||(a[7]=e=>p("dash"))},{default:u((()=>[(i(),w(v,{key:0,value:0,label:"实线"})),(i(),w(v,{key:1,value:1,label:"虚线"}))])),_:1},8,["modelValue"])])),_:1}),s(l,{label:"圆角",name:"borderRadius"},{default:u((()=>[s(_,{min:0,max:1,step:.01,modelValue:n.value.borderRadius,"onUpdate:modelValue":a[8]||(a[8]=e=>n.value.borderRadius=e),onChange:a[9]||(a[9]=e=>p("borderRadius"))},null,8,["modelValue"])])),_:1}),s(l,{label:"不透明度",name:"globalAlpha"},{default:u((()=>[s(k,{modelValue:n.value.globalAlpha,"onUpdate:modelValue":a[10]||(a[10]=e=>n.value.globalAlpha=e),min:0,max:1,step:.01,onChange:a[11]||(a[11]=e=>p("globalAlpha"))},null,8,["modelValue"]),r("span",se,g(n.value.globalAlpha),1)])),_:1}),s(A),s(l,{label:"X",name:"x"},{default:u((()=>[s(_,{modelValue:m.value.x,"onUpdate:modelValue":a[12]||(a[12]=e=>m.value.x=e),onChange:a[13]||(a[13]=e=>b("x"))},null,8,["modelValue"])])),_:1}),s(l,{label:"Y",name:"y"},{default:u((()=>[s(_,{modelValue:m.value.y,"onUpdate:modelValue":a[14]||(a[14]=e=>m.value.y=e),onChange:a[15]||(a[15]=e=>b("y"))},null,8,["modelValue"])])),_:1}),s(l,{label:"宽",name:"width"},{default:u((()=>[s(_,{modelValue:m.value.width,"onUpdate:modelValue":a[16]||(a[16]=e=>m.value.width=e),onChange:a[17]||(a[17]=e=>b("width"))},null,8,["modelValue"])])),_:1}),s(l,{label:"高",name:"height"},{default:u((()=>[s(_,{modelValue:m.value.height,"onUpdate:modelValue":a[18]||(a[18]=e=>m.value.height=e),onChange:a[19]||(a[19]=e=>b("height"))},null,8,["modelValue"])])),_:1}),s(A),s(l,{label:"文字水平对齐",name:"textAlign"},{default:u((()=>[s(h,{modelValue:n.value.textAlign,"onUpdate:modelValue":a[20]||(a[20]=e=>n.value.textAlign=e),onChange:a[21]||(a[21]=e=>p("textAlign"))},{default:u((()=>[s(v,{key:"left",value:"left",label:"左对齐"}),s(v,{key:"center",value:"center",label:"居中"}),s(v,{key:"right",value:"right",label:"右对齐"})])),_:1},8,["modelValue"])])),_:1}),s(l,{label:"文字垂直对齐",name:"textBaseline"},{default:u((()=>[s(h,{modelValue:n.value.textBaseline,"onUpdate:modelValue":a[22]||(a[22]=e=>n.value.textBaseline=e),onChange:a[23]||(a[23]=e=>p("textBaseline"))},{default:u((()=>[s(v,{key:"top",value:"top",label:"顶部对齐"}),s(v,{key:"middle",value:"middle",label:"居中"}),s(v,{key:"bottom",value:"bottom",label:"底部对齐"})])),_:1},8,["modelValue"])])),_:1}),s(A),s(L,null,{default:u((()=>[s(U,{onClick:x},{default:u((()=>a[24]||(a[24]=[f("置顶")]))),_:1,__:[24]}),s(U,{onClick:y},{default:u((()=>a[25]||(a[25]=[f("置底")]))),_:1,__:[25]}),s(U,{onClick:V},{default:u((()=>a[26]||(a[26]=[f("上一层")]))),_:1,__:[26]}),s(U,{onClick:S},{default:u((()=>a[27]||(a[27]=[f("下一层")]))),_:1,__:[27]})])),_:1})])),_:1,__:[28]})):C("",!0)])}}}),[["__scopeId","data-v-6d34e1c9"]]),me={class:"app-props"},ce=R(e({__name:"Props",setup(e){const{selections:a}=E();return(e,t)=>(i(),d("div",me,[y(a).mode===y(P).File?(i(),w(de,{key:0})):y(a).mode===y(P).Pen?(i(),w(ue,{key:1})):C("",!0)]))}}),[["__scopeId","data-v-d3ccf652"]]),ge={class:"app-page"},ve={class:"designer"},fe=R(e({__name:"Index",setup(e){let a;function t(){a&&clearTimeout(a),a=setTimeout((()=>{const e=meta2d.data();localStorage.setItem("meta2d",JSON.stringify(e)),a=void 0}),1e3)}return l((()=>{meta2d.on("scale",t),meta2d.on("add",t),meta2d.on("opened",t),meta2d.on("undo",t),meta2d.on("redo",t),meta2d.on("add",t),meta2d.on("delete",t),meta2d.on("rotatePens",t),meta2d.on("translatePens",t)})),(e,a)=>(i(),d("div",ge,[s(ee),r("div",ve,[s(oe),s(O),s(ce)])]))}}),[["__scopeId","data-v-f192b0ea"]]);export{fe as default};
//# sourceMappingURL=Index-b5c12216.js.map
